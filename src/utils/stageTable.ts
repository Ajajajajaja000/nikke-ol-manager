import type { OLAttr } from '../types/overload';

export const TABLES: Record<OLAttr, number[]> = {
  atk_pct: [
    4.77, 5.47, 6.18, 6.88, 7.59,
    8.29, 9.00, 9.70, 10.40, 11.11,
    11.81, 12.52, 13.22, 13.93, 14.63,
  ],
  crit_rate_pct: [
    2.30, 2.77, 3.23, 3.70, 4.17,
    4.63, 5.10, 5.57, 6.03, 6.50,
    6.96, 7.07, 7.07, 7.07, 7.07,
  ],
  crit_dmg_pct: [
    6.64, 7.62, 8.60, 9.58, 10.56, 11.54,
    12.52, 13.50, 14.48, 15.46, 16.44,
    17.42, 18.40, 19.38, 20.36,
  ],
  hit_rate_pct: [
    4.77, 5.47, 6.18, 6.88, 7.59,
    8.29, 9.00, 9.70, 10.40, 11.11,
    11.81, 12.52, 13.22, 13.93, 14.63,
  ],
  ammo_max_pct: [
    27.84, 31.95, 36.06, 40.17, 44.28,
    48.39, 52.50, 56.60, 60.71, 64.82,
    68.93, 73.04, 77.15, 81.26, 85.37,
  ],
  charge_dmg_pct: [
    4.77, 5.47, 6.18, 6.88, 7.59,
    8.29, 9.00, 9.70, 10.40, 11.11,
    11.81, 12.52, 13.22, 13.93, 14.63,
  ],
  charge_speed_pct: [
    1.98, 2.28, 2.57, 2.86, 3.16,
    3.45, 3.75, 4.04, 4.33, 4.63,
    4.92, 5.21, 5.51, 5.80, 6.09,
  ],
  element_dmg_pct: [
    9.54, 10.94, 12.34, 13.75, 15.15,
    16.55, 17.95, 19.35, 20.75, 22.15,
    23.56, 24.96, 26.36, 27.76, 29.16,
  ],
  def_pct: [
    4.77, 5.47, 6.18, 6.88, 7.59,
    8.29, 9.00, 9.70, 10.40, 11.11,
    11.81, 12.52, 13.22, 13.93, 14.63,
  ],
};

export function getStage(attr: OLAttr, v: number): number {
  const row = TABLES[attr];
  const idx = row.findIndex((n) => Math.abs(n - v) < 0.01);
  return idx === -1 ? 0 : idx + 1;
}

export const attrLabels: Record<OLAttr, string> = {
  atk_pct: '攻撃力増加',
  crit_rate_pct: 'クリティカル確率増加',
  crit_dmg_pct: 'クリティカルダメージ増加',
  hit_rate_pct: '命中率増加',
  ammo_max_pct: '最大装弾数増加',
  charge_dmg_pct: 'チャージダメージ増加',
  charge_speed_pct: 'チャージ速度増加',
  element_dmg_pct: '有利コードダメージ増加',
  def_pct: '防御力増加',
};
